<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=utf8" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="next" href="Caqti_sigs.POOL.html">
<link rel="Up" href="Caqti_sigs.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Caqti" rel="Chapter" href="Caqti.html">
<link title="Caqti_describe" rel="Chapter" href="Caqti_describe.html">
<link title="Caqti_metadata" rel="Chapter" href="Caqti_metadata.html">
<link title="Caqti_plugin" rel="Chapter" href="Caqti_plugin.html">
<link title="Caqti_pool" rel="Chapter" href="Caqti_pool.html">
<link title="Caqti_sigs" rel="Chapter" href="Caqti_sigs.html">
<link title="Caqti_query" rel="Chapter" href="Caqti_query.html"><link title="Querying " rel="Section" href="#3_Querying">
<link title="Parameter and Tuple Coding" rel="Section" href="#3_ParameterandTupleCoding">
<title>The Caqti API : Caqti_sigs.CONNECTION</title>
</head>
<body>
<div class="navbar">&nbsp;<a class="up" href="Caqti_sigs.html" title="Caqti_sigs">Up</a>
&nbsp;<a class="post" href="Caqti_sigs.POOL.html" title="Caqti_sigs.POOL">Next</a>
</div>
<h1>Module type <a href="type_Caqti_sigs.CONNECTION.html">Caqti_sigs.CONNECTION</a></h1>

<pre><span class="keyword">module type</span> CONNECTION = <code class="code">sig</code> <a href="Caqti_sigs.CONNECTION.html">..</a> <code class="code">end</code></pre><div class="info modtype top">
The main API as provided after connecting to a resource.<br>
</div>
<hr width="100%">

<pre><span id="TYPEio"><span class="keyword">type</span> <code class="type">'a</code> io</span> </pre>
<div class="info ">
The IO monad for which the module is specialized.<br>
</div>


<pre><span id="TYPEparam"><span class="keyword">type</span> <code class="type"></code>param</span> </pre>
<div class="info ">
An abstract type for a query parameter.  Only the backend knows the
      actual type.<br>
</div>


<pre><span id="TYPEtuple"><span class="keyword">type</span> <code class="type"></code>tuple</span> </pre>
<div class="info ">
An abstract type for a tuple passed by a backend to callbacks during
      query execution.<br>
</div>


<pre><span id="VALuri"><span class="keyword">val</span> uri</span> : <code class="type">Uri.t</code></pre><div class="info ">
The connected URI.<br>
</div>

<pre><span id="VALbackend_info"><span class="keyword">val</span> backend_info</span> : <code class="type"><a href="Caqti_metadata.html#TYPEbackend_info">Caqti_metadata.backend_info</a></code></pre><div class="info ">
Various metadata about the backend which provides the connection.<br>
</div>

<pre><span id="VALdisconnect"><span class="keyword">val</span> disconnect</span> : <code class="type">unit -> unit <a href="Caqti_sigs.CONNECTION.html#TYPEio">io</a></code></pre><div class="info ">
Calling <code class="code">disconnect ()</code> closes the connection to the database and frees
      up related resources.<br>
</div>

<pre><span id="VALvalidate"><span class="keyword">val</span> validate</span> : <code class="type">unit -> bool <a href="Caqti_sigs.CONNECTION.html#TYPEio">io</a></code></pre><div class="info ">
For internal use by <a href="Caqti_pool.html"><code class="code">Caqti_pool</code></a>.  Tries to ensure the validity of the
      connection and must return <code class="code">false</code> if unsuccessful.<br>
</div>

<pre><span id="VALcheck"><span class="keyword">val</span> check</span> : <code class="type">(bool -> unit) -> unit</code></pre><div class="info ">
For internal use by <a href="Caqti_pool.html"><code class="code">Caqti_pool</code></a>.  Called after a connection has been
      used.  <code class="code">check f</code> must call <code class="code">f ()</code> exactly once with an argument
      indicating whether to keep the connection in the pool or discard it.<br>
</div>

<pre><span id="VALdescribe"><span class="keyword">val</span> describe</span> : <code class="type"><a href="Caqti_query.html#TYPEquery">Caqti_query.query</a> -> <a href="Caqti_describe.html#TYPEquerydesc">Caqti_describe.querydesc</a> <a href="Caqti_sigs.CONNECTION.html#TYPEio">io</a></code></pre><div class="info ">
Returns a description of parameters and returned tuples.  What is
      returned may be limited by what the underlying library supports.  The
      number of paratemers and tuple components should be correct, but the
      types may be <code class="code">`Unknown</code>.<br>
</div>
<br>
<h3 id="3_Querying">Querying </h3><br>

<pre><span id="VALexec"><span class="keyword">val</span> exec</span> : <code class="type"><a href="Caqti_query.html#TYPEquery">Caqti_query.query</a> -><br>       <a href="Caqti_sigs.CONNECTION.html#TYPEparam">param</a> array -> unit <a href="Caqti_sigs.CONNECTION.html#TYPEio">io</a></code></pre><div class="info ">
<code class="code">exec q params</code> executes a query <code class="code">q(params)</code> which is not expected to
      return anything.<br>
</div>

<pre><span id="VALfind"><span class="keyword">val</span> find</span> : <code class="type"><a href="Caqti_query.html#TYPEquery">Caqti_query.query</a> -><br>       (<a href="Caqti_sigs.CONNECTION.html#TYPEtuple">tuple</a> -> 'a) -><br>       <a href="Caqti_sigs.CONNECTION.html#TYPEparam">param</a> array -> 'a option <a href="Caqti_sigs.CONNECTION.html#TYPEio">io</a></code></pre><div class="info ">
<code class="code">find q params</code> executes a query <code class="code">q(params)</code> which is expected to return
      at most one tuple.<br>
</div>

<pre><span id="VALfold"><span class="keyword">val</span> fold</span> : <code class="type"><a href="Caqti_query.html#TYPEquery">Caqti_query.query</a> -><br>       (<a href="Caqti_sigs.CONNECTION.html#TYPEtuple">tuple</a> -> 'a -> 'a) -><br>       <a href="Caqti_sigs.CONNECTION.html#TYPEparam">param</a> array -> 'a -> 'a <a href="Caqti_sigs.CONNECTION.html#TYPEio">io</a></code></pre><div class="info ">
<code class="code">fold q f params acc</code> executes <code class="code">q(params)</code>, composes <code class="code">f</code> over the
      resulting tuples in order, and applies the composition to <code class="code">acc</code>.<br>
</div>

<pre><span id="VALfold_s"><span class="keyword">val</span> fold_s</span> : <code class="type"><a href="Caqti_query.html#TYPEquery">Caqti_query.query</a> -><br>       (<a href="Caqti_sigs.CONNECTION.html#TYPEtuple">tuple</a> -> 'a -> 'a <a href="Caqti_sigs.CONNECTION.html#TYPEio">io</a>) -><br>       <a href="Caqti_sigs.CONNECTION.html#TYPEparam">param</a> array -> 'a -> 'a <a href="Caqti_sigs.CONNECTION.html#TYPEio">io</a></code></pre><div class="info ">
<code class="code">fold_s q f params acc</code> executes <code class="code">q(params)</code>, forms a threaded
      composition of <code class="code">f</code> over the resulting tuples, and applies the
      composition to <code class="code">acc</code>.<br>
</div>

<pre><span id="VALiter_p"><span class="keyword">val</span> iter_p</span> : <code class="type"><a href="Caqti_query.html#TYPEquery">Caqti_query.query</a> -><br>       (<a href="Caqti_sigs.CONNECTION.html#TYPEtuple">tuple</a> -> unit <a href="Caqti_sigs.CONNECTION.html#TYPEio">io</a>) -><br>       <a href="Caqti_sigs.CONNECTION.html#TYPEparam">param</a> array -> unit <a href="Caqti_sigs.CONNECTION.html#TYPEio">io</a></code></pre><div class="info ">
<code class="code">fold_p q f params</code> executes <code class="code">q(params)</code> and calls <code class="code">f t</code> in the thread
      monad in parallel for each resulting tuple <code class="code">t</code>.  A certain backend may
      not implement parallel execution, in which case this is the same as
      <a href="Caqti_sigs.CONNECTION.html#VALiter_s"><code class="code">Caqti_sigs.CONNECTION.iter_s</code></a>.<br>
</div>

<pre><span id="VALiter_s"><span class="keyword">val</span> iter_s</span> : <code class="type"><a href="Caqti_query.html#TYPEquery">Caqti_query.query</a> -><br>       (<a href="Caqti_sigs.CONNECTION.html#TYPEtuple">tuple</a> -> unit <a href="Caqti_sigs.CONNECTION.html#TYPEio">io</a>) -><br>       <a href="Caqti_sigs.CONNECTION.html#TYPEparam">param</a> array -> unit <a href="Caqti_sigs.CONNECTION.html#TYPEio">io</a></code></pre><div class="info ">
<code class="code">fold_s q f params</code> executes <code class="code">q(params)</code> and calls <code class="code">f t</code> sequentially in
      the thread monad for each resulting tuple <code class="code">t</code> in order.<br>
</div>
<br>
<h3 id="3_ParameterandTupleCoding">Parameter and Tuple Coding</h3><br>

<pre><span class="keyword">module</span> <a href="Caqti_sigs.CONNECTION.Param.html">Param</a>: <code class="code">sig</code> <a href="Caqti_sigs.CONNECTION.Param.html">..</a> <code class="code">end</code></pre><div class="info">
Parameter encoding functions.
</div>

<pre><span class="keyword">module</span> <a href="Caqti_sigs.CONNECTION.Tuple.html">Tuple</a>: <code class="code">sig</code> <a href="Caqti_sigs.CONNECTION.Tuple.html">..</a> <code class="code">end</code></pre><div class="info">
Tuple decoding functions.
</div>
</body></html>