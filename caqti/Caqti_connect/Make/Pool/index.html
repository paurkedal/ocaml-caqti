<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Pool (caqti.Caqti_connect.Make.Pool)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../../../index.html">caqti</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Caqti_connect.Make.Pool</span></h1></header><div class="doc"><p>A pool implementation for the current concurrency library.</p></div><div class="spec type" id="type-future"><a href="#type-future" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>'a future</code><code></code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>('a, +'e) t</code><code></code><code></code></div><div class="doc"></div></div><div class="spec val" id="val-create"><a href="#val-create" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>create : ?&#8288;max_size:int <span class="keyword">&#8209;&gt;</span> ?&#8288;check:(<span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> (bool <span class="keyword">&#8209;&gt;</span> unit) <span class="keyword">&#8209;&gt;</span> unit) <span class="keyword">&#8209;&gt;</span> ?&#8288;validate:(<span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> bool <a href="index.html#type-future">future</a>) <span class="keyword">&#8209;&gt;</span> (unit <span class="keyword">&#8209;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'e</span>) Pervasives.result <a href="index.html#type-future">future</a>) <span class="keyword">&#8209;&gt;</span> (<span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> unit <a href="index.html#type-future">future</a>) <span class="keyword">&#8209;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'e</span>) <a href="index.html#type-t">t</a></code></div><div class="doc"><p><b>Internal:</b><code class="code">create alloc free</code> is a pool of resources allocated by
<code class="code">alloc</code> and freed by <code class="code">free</code>. This is primarily indented for implementing
the <code class="code">connect_pool</code> functions.</p><ul class="at-tag"><li><span class="at-tag parameter">Parameter</span> <span class="module-path">max_size</span>: Maximum number of resources to allocate at any given time.</li><li><span class="at-tag parameter">Parameter</span> <span class="module-path">check</span>: A function used to check a resource after use.</li><li><span class="at-tag parameter">Parameter</span> <span class="module-path">validate</span>: A function to check before use that a resource is still valid.</li></ul></div></div><div class="spec val" id="val-size"><a href="#val-size" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>size : (<span class="type-var">'a</span>, <span class="type-var">'e</span>) <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> int</code></div><div class="doc"><p><code class="code">size pool</code> is the current number of open resources in <code class="code">pool</code>.</p></div></div><div class="spec val" id="val-use"><a href="#val-use" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>use : ?&#8288;priority:float <span class="keyword">&#8209;&gt;</span> (<span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> (<span class="type-var">'b</span>, <span class="type-var">'e</span>) Pervasives.result <a href="index.html#type-future">future</a>) <span class="keyword">&#8209;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'e</span>) <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> (<span class="type-var">'b</span>, <span class="type-var">'e</span>) Pervasives.result <a href="index.html#type-future">future</a></code></div><div class="doc"><p><code class="code">use f pool</code> calls <code class="code">f</code> on a resource drawn from <code class="code">pool</code>, handing back the
resource to the pool when <code class="code">f</code> exits.</p><ul class="at-tag"><li><span class="at-tag parameter">Parameter</span> <span class="module-path">priority</span>: Requests for the resource are handled in decreasing order of priority.
The default priority is <code class="code">0.0</code>.</li></ul></div></div><div class="spec val" id="val-drain"><a href="#val-drain" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>drain : (<span class="type-var">'a</span>, <span class="type-var">'e</span>) <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> unit <a href="index.html#type-future">future</a></code></div><div class="doc"><p><code class="code">drain pool</code> closes all resources in <code class="code">pool</code>. The pool is still usable, as
new resources will be created on demand.</p></div></div></body></html>