<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Caqti_pool_config (caqti.Caqti_pool_config)</title><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">caqti</a> &#x00BB; Caqti_pool_config</nav><header class="odoc-preamble"><h1>Module <code><span>Caqti_pool_config</span></code></h1><p>Pool configuration.</p></header><nav class="odoc-toc"><ul><li><a href="#construction-and-generic-operations">Construction and Generic Operations</a></li><li><a href="#cpck">Configuration Keys</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-key"><a href="#type-key" class="anchor"></a><code><span><span class="keyword">type</span> <span>_ key</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div></div><h3 id="construction-and-generic-operations"><a href="#construction-and-generic-operations" class="anchor"></a>Construction and Generic Operations</h3><div class="odoc-spec"><div class="spec value anchored" id="val-create"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : 
  <span>?max_size:int <span class="arrow">&#45;&gt;</span></span>
  <span>?max_idle_size:int <span class="arrow">&#45;&gt;</span></span>
  <span>?max_idle_age:<span><span class="xref-unresolved">Mtime</span>.Span.t option</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?max_use_count:<span>int option</span> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Creates a configuration for the implementation of <a href="../Caqti_pool_sig/module-type-S/index.html"><code>Caqti_pool_sig.S</code></a>. The main arguments populate the configuration with the corresponding settings, which are explaind in <a href="#cpck">Configuration Keys</a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default"><a href="#val-default" class="anchor"></a><code><span><span class="keyword">val</span> default : <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>The configuration object with no setting, which gives the built-in defaults. Alternatively, use <a href="#val-default_from_env"><code>default_from_env</code></a> for a configuration based on environment variables.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_from_env"><a href="#val-default_from_env" class="anchor"></a><code><span><span class="keyword">val</span> default_from_env : <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>default_from_env ()</code> is a configuration constructed from environment variables of the form <code>CAQTI_POOL_&lt;suffix&gt;</code>, with the upper-cased names of the configuration keys substituted for <code>&lt;suffix&gt;</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-merge_left"><a href="#val-merge_left" class="anchor"></a><code><span><span class="keyword">val</span> merge_left : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>merge_left cL cR</code> is the configuration <code>cL</code> with missing settings populated by the corresponding present settings from <code>cR</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get"><a href="#val-get" class="anchor"></a><code><span><span class="keyword">val</span> get : <span><span><span class="type-var">'a</span> <a href="#type-key">key</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> option</span></span></code></div><div class="spec-doc"><p><code>get key config</code> is the value of <code>key</code> in <code>config</code> or <code>None</code> if unset.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set"><a href="#val-set" class="anchor"></a><code><span><span class="keyword">val</span> set : <span><span><span class="type-var">'a</span> <a href="#type-key">key</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>set key value config</code> is <code>config</code> with <code>key</code> set to <code>value</code> regardless of any previous mapping.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unset"><a href="#val-unset" class="anchor"></a><code><span><span class="keyword">val</span> unset : <span><span><span class="type-var">'a</span> <a href="#type-key">key</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>unset key config</code> is <code>config</code> without its mapping for <code>key</code> if any.</p></div></div><h3 id="cpck"><a href="#cpck" class="anchor"></a>Configuration Keys</h3><div class="odoc-spec"><div class="spec value anchored" id="val-max_size"><a href="#val-max_size" class="anchor"></a><code><span><span class="keyword">val</span> max_size : <span>int <a href="#type-key">key</a></span></span></code></div><div class="spec-doc"><p>The maximum number of open connections associated with the pool. When this limit is hit, an attempt to use the pool will block until a connection becomes available. The value must be at least one. If the selected driver does not support concurrent connections, the value <code>1</code> is assumed.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-max_idle_size"><a href="#val-max_idle_size" class="anchor"></a><code><span><span class="keyword">val</span> max_idle_size : <span>int <a href="#type-key">key</a></span></span></code></div><div class="spec-doc"><p>The maximum number of idle connections to put into the pool for reuse. Must be between <code>0</code> and <a href="#val-max_size"><code>max_size</code></a>. If you set this, you must also ensure <a href="#val-max_size"><code>max_size</code></a> is set so that the combination is valid. Defaults to <a href="#val-max_size"><code>max_size</code></a>. For drivers which does not support concurrent connections, the value will clipped to a maximum of <code>1</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-max_idle_age"><a href="#val-max_idle_age" class="anchor"></a><code><span><span class="keyword">val</span> max_idle_age : <span><span><span class="xref-unresolved">Mtime</span>.Span.t option</span> <a href="#type-key">key</a></span></span></code></div><div class="spec-doc"><p>The maximum age of idle connections before they are scheduled to be disconnected and removed from the pool, or <code>None</code> for no limit. Where possible, a timer will be used to trigger the cleanup. For the <code>caqti.blocking</code> library, the cleanup will only be done opportunistically when the pool is used.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-max_use_count"><a href="#val-max_use_count" class="anchor"></a><code><span><span class="keyword">val</span> max_use_count : <span><span>int option</span> <a href="#type-key">key</a></span></span></code></div><div class="spec-doc"><p>The maximum number of times a pooled connection is reused, or <code>None</code> for no limit. The default is currently 100, but may be changed in the future based on real-world experience. The reason this setting was introduced is that we have seen state being retained on the server side.</p></div></div></div></body></html>